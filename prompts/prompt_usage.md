# Prompt Usage Guide

## When Each Prompt is Used

### Chain-of-Thought Prompt (`cot_prompt.txt`)
- **Used For**: Initial test case generation for new contracts
- **Triggers**: When a new contract is loaded into the fuzzer
- **Temperature**: 0.8 (more exploratory)
- **Cases Generated**: 5 per call
- **Purpose**: Step-by-step vulnerability analysis with reasoning

Example usage:
```python
if mode in ['llm-cot', 'llm-full']:
    prompt = self._build_cot_prompt(num_cases)
```

### Basic Prompt (`basic_prompt.txt`)  
- **Used For**: Simple test case generation without complex reasoning
- **Triggers**: Fallback when CoT fails, or for quick generation
- **Temperature**: 0.5 (more focused)
- **Cases Generated**: 3 per call
- **Purpose**: Direct test case creation

### Mutation Enhancement
For mutation phase, we don't use fixed prompts but rather dynamic strategies generated by LLM mutator based on successful test cases. The LLM analyzes execution logs and creates context-specific mutation guidance.

```python
# Amplify-and-deepen approach
if new_coverage_detected:
    mutation_strategy = llm_mutator.get_mutation_strategy(
        execution_logs, 
        successful_test_case, 
        coverage_info
    )
```

## Prompt Selection Logic in Code

```python
def select_prompt_mode(phase, contract_state):
    if phase == "init" and contract_state == "new":
        if mode == 'llm-cot' or mode == 'llm-full':
            return "cot_prompt.txt"
        elif mode == 'llm':
            return "basic_prompt.txt"
    elif phase == "mutation":
        # Use dynamic strategy, not fixed prompt
        return None  # Dynamic mutation guidance
    else:
        return "basic_prompt.txt"  # fallback
```

## Key Differences

| Phase | Approach | Temperature | Focus |
|-------|----------|-------------|--------|
| Initial | CoT reasoning | 0.8 | Broad vulnerability exploration |
| Mutation | Context-specific strategy | 0.5 | Targeted improvement of promising cases |  
| Fallback | Direct generation | 0.5 | Quick valid test cases |

The mutation phase is particularly important because it uses the "amplify-and-deepen" strategy where LLM focuses on areas where baseline fuzzer already found something interesting, rather than random exploration.